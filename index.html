<!DOCTYPE html>
<html lang="pt-br" ng-app="estagio">

<head>
    <meta charset="utf-8"/>
    <title>Gerenciador de cidades</title>
    <!-- BOOTSTRAP -->
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css"/>
    <!-- SYNTAX HIGHLIGHTER -->
    <link href="http://agorbatchev.typepad.com/pub/sh/3_0_83/styles/shCore.css" rel="stylesheet">
    <link href="http://agorbatchev.typepad.com/pub/sh/3_0_83/styles/shThemeDefault.css" rel="stylesheet">
    <link href="http://agorbatchev.typepad.com/pub/sh/3_0_83/styles/shThemeRDark.css" rel="stylesheet">
    <!--  -->
    <link rel="stylesheet" href="node_modules/angular-loading-bar/build/loading-bar.min.css"/>
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="node_modules/angular-route/angular-route.min.js"></script>
    <script src="node_modules/angular-animate/angular-animate.min.js"></script>
    <script src="node_modules/angular-loading-bar/build/loading-bar.min.js"></script>
    <script src="app.js"></script>
</head>

<body ng-controller="MainController">
<div id="centerSpin" style="position:fixed;top:50%;left:50%;z-index:15000;"></div>
<div class="container">
    <button class="btn btn-default" type="button" ng-click="salvar(projects.projects[0])">{{projects}}</button>
    <button class="btn btn-default" type="button" ng-click="clearAll()">limpar memória</button>
    <div class="row">
        <table class="table table-hover table-striped">
            <thead>
            <tr>
                <th>#</th>
                <th>Nome</th>
                <th>Ação</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="project in projects">
                <td>{{$index}}</td>
                <td>{{project}}</td>
                <td>
                    <button type="button" class="btn btn-primary btn-xs" ng-click="listSpiders(project)">
                        <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
        <table class="table table-hover table-striped">
            <thead>
            <tr>
                <th>#</th>
                <th>Nome</th>
                <th>Ação</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="spider in spiders">
                <td>{{$index}}</td>
                <td>{{spider}}</td>
                <td>
                    <button type="button" class="btn btn-primary btn-xs" ng-click="listFilesAndJobs(spider)">
                        <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                    </button>
                    <button type="button" class="btn btn-primary btn-xs" ng-click="schedule(spider)">
                        <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                    </button>
                    <button type="button" class="btn btn-primary btn-xs" ng-click="scheduleWithState(spider)">
                        <span class="glyphicon glyphicon-play-circle" aria-hidden="true"></span>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>

        <table class="table table-hover table-striped">
            <thead>
            <tr>
                <th>#</th>
                <th>Job</th>
                <th>Estado</th>
                <th>Resumo</th>
                <th>Ações</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="file in files">
                <td>{{$index+1}}</td>
                <td>{{file | limitTo:file.length-4}}</td>
                <td>{{fileResume.ultimoEstado[$index]}}</td>
                <td>{{fileResume.itemsRaspados[$index]}}</td>
                <td>
                    <button type="button" class="btn btn-primary btn-xs"
                            ng-click="showFileResume($index, file | limitTo:file.length-3)">
                        <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
                    </button>
                    <a ng-href="{{serverScrapyd}}items/{{_project}}/{{_spider}}/{{file}}"> Items </a>
                    <a ng-href="{{serverScrapyd}}logs/{{_project}}/{{_spider}}/{{file | limitTo:file.length-4}}.log">Log </a>
                    <button type="button" class="btn btn-cancel btn-xs" ng-click="scheduleWithState(_spider, file | limitTo:file.length-4)">
                        <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                    </button>
                </td>
            </tr>
            <!--<tr>-->
            <!--<td>Totais</td>-->
            <!--<td>{{files.length}} job(s)</td>-->
            <!--<td>-</td>-->
            <!--<td>{{fileResume.totais['itemsRaspados']}}</td>-->
            <!--<td>-</td>-->
            <!--</tr>-->
            </tbody>
        </table>

        <table class="table table-hover table-striped">
            <thead>
            <tr>
                <th>#</th>
                <th>Job</th>
                <th>Estado</th>
                <th>Resumo</th>
                <th>Ações</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="job in jobs">
                <td>{{$index+1}}</td>
                <td>{{job.job}}</td>
                <td>{{job.state}}</td>
                <td>{{job.resume}}</td>
                <td>
                    <!--<button type="checkbox" class="btn btn-primary btn-xs" ng-click="monitorJob(serverScrapyd + 'logs/' + job.project + '/' + job.spider +'/'+ job.job + 'log')">-->
                    <button type="checkbox" class="btn btn-primary btn-xs" ng-click="monitorJob(job)">
                        <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
                    </button>
                    <a ng-href="{{serverScrapyd}}items/{{job.project}}/{{job.spider}}/{{job.job}}.csv"> items </a>
                    <a ng-href="{{serverScrapyd}}logs/{{job.project}}/{{job.spider}}/{{job.job}}.log"> log </a>
                    <button type="button" class="btn btn-cancel btn-xs" ng-click="cancel(job.project, job.id)">
                        <span class="glyphicon glyphicon-pause" aria-hidden="true"></span>
                    </button>
                </td>
            </tr>
            <!--<tr>-->
            <!--<td>Totais</td>-->
            <!--<td>{{files.length}} job(s)</td>-->
            <!--<td>-</td>-->
            <!--<td>{{fileResume.totais['itemsRaspados']}}</td>-->
            <!--<td>-</td>-->
            <!--</tr>-->
            </tbody>
        </table>
    </div>
</div>

<h3 class="text-center" id="spider_file"></h3>
<div class="row" id="spider_content">
    <pre class="brush: bash"></pre>
</div>
<button type="button" class="btn btn-warning"
        ng-click="get_file('http://localhost:6800/logs/tutorial/lab/86c9cd705e6c11e6a2f7902b34f05b7e.log');"><i
        class="fa fa-fast-forward"></i></button>
</body>


<!-- JQUERY -->
<script src="node_modules/jquery/dist/jquery.min.js"></script>
<!-- BOOTSTRAP -->
<script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- MOMENT -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.3/moment.min.js"></script>
<!-- SPIN -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/spin.js/2.0.1/spin.min.js"></script>
<script src="spinner.js"></script>
<!-- SYNTAX HIGHLIGHTER -->
<script src="http://agorbatchev.typepad.com/pub/sh/3_0_83/scripts/shCore.js"></script>
<script src="http://agorbatchev.typepad.com/pub/sh/3_0_83/scripts/shBrushBash.js"></script>

</html>
